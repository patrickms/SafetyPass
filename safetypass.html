<html>
<head>
<script src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/md5.js"></script>
<style>
    @font-face {
    font-family: passwordFont;
    src: url(password.ttf);
}

#domainpass {
    font-family: passwordFont;
}

body{
    color:white;
}
input, textarea, select{font-family:inherit;}

.input{
padding:5px;
font-size:16px;
color:black;
width:100%;
}
</style>
</head>
<body bgcolor="#000000">

    <form style="width:100%; float:left">
        <div style="width: 100%; float:left">
            <div style="width: 50%; float:left">
                 Domain:
            </div>
            
            <div style="width: 50%; float:right">
               <input id="domain" type="text" name="domain">
            </div>
        </div>
         <br>
        <div style="width: 100%; float:left">
            <div style="width: 50%; float:left">
                 Master Password:
            </div>
            
            <div style="width: 50%; float:right">
               <input id="masterpass" type="password" name="masterpass">
            </div>
        </div>
         <br>
        <div style="width: 100%; float:left">
            <div style="width: 50%; float:left">
                 Domain Password:
            </div>
            
            <div style="width: 50%; float:right">
               <input id="domainpass" type="text" name="domainpass">
            </div>
        </div>
         <br>
        <div id="copyme" style="width: 100%; float:left">
            <p></p>
        </div>
         <br>
        <div style="width: 100%; float:left">
            <div style="width: 50%; float:left">
                 <input type="button" formnovalidate value="Close" onclick="javascript: doClose();"/>
            </div>
            
            <div style="width: 50%; float:right">
               <input type="button" formnovalidate value="Generate Password" onclick="javascript: genPass();"/>
            </div>
        </div>
    </form>
<script>
    var hash = CryptoJS.MD5("Message");
    var PARENT_DOMAIN=""
    //alert("Message: "+hash)
    window.parent.postMessage("Which Domain?","*");
    //alert('sent');
    window.addEventListener("message", receiveMessage, false);

    function receiveMessage(event)
    {
        document.getElementById("domain").value=event.data;
        
          // ...
    }
    
    function genPass()
    {
        var hash = CryptoJS.MD5(document.getElementById("domain").value + " " + document.getElementById("masterpass").value);
        //alert("hash: "+hash)
        var domainPass=document.getElementById("domainpass");
        domainPass.setAttribute("value","A$"+hash.toString());
        //domainPass.select();
        domainPass.selectionStart=0;
        domainPass.selectionEnd=domainPass.value.length;
        document.getElementById("copyme").innerHTML="Copy the password above...";
    }

    function doClose()
    {
        window.parent.postMessage("Close SafetyPass","*");
        
          // ...
    }

</script>
</body>
</html>
